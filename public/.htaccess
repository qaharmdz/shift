<IfModule mod_autoindex.c>
    Options -Indexes
    ErrorDocument 403 "Restricted access"
</IfModule>

<IfModule mod_rewrite.c>
    RewriteEngine On
    Options +FollowSymlinks

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^.*\.(ico|gif|jpg|jpeg|png|js|css|map)$ [NC]

    # Direct Route
    # example.com/r/content/page?page_id=1 === example.com/index.php?route=content/page&page_id=1
    RewriteRule ^r/(.*)$ index.php?route=$1 [L,QSA]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^.*\.(ico|gif|jpg|jpeg|png|js|css|map)$ [NC]

    # Route Alias
    # example.com/about_us === example.com/index.php?_route_=about_us
    RewriteRule ^(index\.php)?(.*)$ index.php?_route_=$2 [L,QSA]
</IfModule>

# Block access to files that can expose sensitive information.
<FilesMatch "(^#.*#|\.(ini|txt|twig|json|xml|log)|~)$">
    # Apache < 2.3
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
        Satisfy All
    </IfModule>

    # Apache â‰¥ 2.3
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>

# https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#response_directives
# Max age 6 month
<filesMatch ".(ico|pdf|flv|jpg|jpeg|png|gif|svg|js|css|swf|woff|woff2)$">
    Header set Cache-Control "max-age=15768000, public"
</filesMatch>

<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access 1 year"
    ExpiresByType image/jpeg "access 1 year"
    ExpiresByType image/gif "access 1 year"
    ExpiresByType image/png "access 1 year"
    ExpiresByType image/svg "access 1 year"
    ExpiresByType text/css "access 1 month"
    ExpiresByType application/pdf "access 1 month"
    ExpiresByType application/javascript "access 1 month"
    ExpiresByType application/x-javascript "access 1 month"
    ExpiresByType application/x-shockwave-flash "access 1 month"
    ExpiresByType image/x-icon "access 1 year"
    ExpiresDefault "access 3 days"
</IfModule>
